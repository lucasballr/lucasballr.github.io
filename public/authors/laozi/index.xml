<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Laozi on Lucas Ball</title>
    <link>http://localhost:1313/authors/laozi/</link>
    <description>Recent content in Laozi on Lucas Ball</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Sun, 12 Feb 2023 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/authors/laozi/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>LACTF 2023</title>
      <link>http://localhost:1313/cyber/lactf23/</link>
      <pubDate>Sun, 12 Feb 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/cyber/lactf23/</guid>
      <description></description>
    </item>
    <item>
      <title>misc/a-hackers-notes</title>
      <link>http://localhost:1313/cyber/lactf23/hacker-notes/</link>
      <pubDate>Sun, 12 Feb 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/cyber/lactf23/hacker-notes/</guid>
      <description>&lt;h3 id=&#34;the-challenge&#34;&gt;&#xA;  The Challenge&#xA;  &lt;a class=&#34;heading-link&#34; href=&#34;#the-challenge&#34;&gt;&#xA;    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;&#xA;    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&#xA;&lt;p&gt;You are given a luks encrypted drive that has a pretty weak password on it.&#xA;All you have to do to open it is run a bruteforce script on the drive:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;bruteforce-luks -t &lt;span style=&#34;color:#fab387&#34;&gt;6&lt;/span&gt; -f dictionary.txt -v &lt;span style=&#34;color:#fab387&#34;&gt;30&lt;/span&gt; hackers-drive.dd&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;dictionary.txt had a bunch of variations of &amp;ldquo;hackerXXX&amp;rdquo; which is the format&#xA;we are told the password is in. The result is &amp;ldquo;hacker765&amp;rdquo; as the password.&#xA;Then you need to mount the drive to take a look at it:&lt;/p&gt;</description>
    </item>
    <item>
      <title>misc/ebe</title>
      <link>http://localhost:1313/cyber/lactf23/ebe/</link>
      <pubDate>Sun, 12 Feb 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/cyber/lactf23/ebe/</guid>
      <description>&lt;h3 id=&#34;the-challenge&#34;&gt;&#xA;  The challenge&#xA;  &lt;a class=&#34;heading-link&#34; href=&#34;#the-challenge&#34;&gt;&#xA;    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;&#xA;    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&#xA;&lt;p&gt;This was just a pcap that had certain flags set for the incorrect&#xA;UDP packets. All you had to to was look at the RFC definition and filter by&#xA;that ip flag. &lt;code&gt;ip.flags.rb == 0&lt;/code&gt;. Then you can just export bytes or read the&#xA;flag one character at a time.&lt;/p&gt;</description>
    </item>
    <item>
      <title>pwn/bot</title>
      <link>http://localhost:1313/cyber/lactf23/bot/</link>
      <pubDate>Sun, 12 Feb 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/cyber/lactf23/bot/</guid>
      <description>&lt;h3 id=&#34;the-challenge&#34;&gt;&#xA;  The challenge&#xA;  &lt;a class=&#34;heading-link&#34; href=&#34;#the-challenge&#34;&gt;&#xA;    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;&#xA;    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&#xA;&lt;p&gt;This was a simple buffer overflow. The program runs &lt;code&gt;gets()&lt;/code&gt; which&#xA;is a huge vulnerability since it doesn&amp;rsquo;t have the size specified.&#xA;There&amp;rsquo;s also a bug with &lt;code&gt;strcmp()&lt;/code&gt; that stops reading the input after&#xA;a NULL byte. So the problem asks for your input and then compares it&#xA;with a few strings before returning. All you have to do is write one&#xA;of the strings terminated with a NULL byte then write the buffer&#xA;overflow. There was a &amp;ldquo;get flag&amp;rdquo; section of the code so I just overwrote&#xA;the return address with that section:&lt;/p&gt;</description>
    </item>
    <item>
      <title>pwn/gatekeep</title>
      <link>http://localhost:1313/cyber/lactf23/gatekeep/</link>
      <pubDate>Sun, 12 Feb 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/cyber/lactf23/gatekeep/</guid>
      <description>&lt;h3 id=&#34;the-challenge&#34;&gt;&#xA;  The challenge&#xA;  &lt;a class=&#34;heading-link&#34; href=&#34;#the-challenge&#34;&gt;&#xA;    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;&#xA;    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&#xA;&lt;p&gt;This is one of the baby intro challenges, so it just checked if your input&#xA;was the same as the program&amp;rsquo;s variable on the stack. You just need to send&#xA;a bunch of &amp;ldquo;A&amp;quot;s to the program to get the flag.&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;‚ùØ ./gatekeep&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;If I gaslight you enough, you won&lt;span style=&#34;color:#a6e3a1&#34;&gt;&amp;#39;t be able to guess my password! :)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e3a1&#34;&gt;Password:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e3a1&#34;&gt;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e3a1&#34;&gt;I swore that was the right password ...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e3a1&#34;&gt;Guess I couldn&amp;#39;&lt;/span&gt;t gaslight you!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;flag&lt;span style=&#34;color:#89dceb;font-weight:bold&#34;&gt;{&lt;/span&gt;ASDASDSADFASDFGASDFASDF&lt;span style=&#34;color:#89dceb;font-weight:bold&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    <item>
      <title>pwn/rick-roll</title>
      <link>http://localhost:1313/cyber/lactf23/rick-roll/</link>
      <pubDate>Sun, 12 Feb 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/cyber/lactf23/rick-roll/</guid>
      <description>&lt;h3 id=&#34;the-vulnerability&#34;&gt;&#xA;  The Vulnerability&#xA;  &lt;a class=&#34;heading-link&#34; href=&#34;#the-vulnerability&#34;&gt;&#xA;    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;&#xA;    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&#xA;&lt;p&gt;This is a simple format string vulnerability. The program gets the user&amp;rsquo;s&#xA;input then calls &lt;code&gt;printf()&lt;/code&gt; on the user&amp;rsquo;s input. This is a very common&#xA;vulnerability and a reason why developers should never be calling printf&#xA;directly on user input. Here&amp;rsquo;s the code from the chall:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f38ba8&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#89b4fa&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#f38ba8&#34;&gt;void&lt;/span&gt;) {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#cba6f7&#34;&gt;if&lt;/span&gt; (main_called) {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#89b4fa&#34;&gt;puts&lt;/span&gt;(&lt;span style=&#34;color:#a6e3a1&#34;&gt;&amp;#34;nice try&amp;#34;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#cba6f7&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#fab387&#34;&gt;1&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    main_called &lt;span style=&#34;color:#89dceb;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#fab387&#34;&gt;1&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#89b4fa&#34;&gt;setbuf&lt;/span&gt;(stdout, &lt;span style=&#34;color:#89dceb&#34;&gt;NULL&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#89b4fa&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#a6e3a1&#34;&gt;&amp;#34;Lyrics: &amp;#34;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f38ba8&#34;&gt;char&lt;/span&gt; buf[&lt;span style=&#34;color:#fab387&#34;&gt;256&lt;/span&gt;];&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#89b4fa&#34;&gt;fgets&lt;/span&gt;(buf, &lt;span style=&#34;color:#fab387&#34;&gt;256&lt;/span&gt;, stdin);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#89b4fa&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#a6e3a1&#34;&gt;&amp;#34;Never gonna give you up, never gonna let you down&lt;/span&gt;&lt;span style=&#34;color:#89b4fa&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#a6e3a1&#34;&gt;Never gonna run around and &amp;#34;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#89b4fa&#34;&gt;printf&lt;/span&gt;(buf);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#89b4fa&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#a6e3a1&#34;&gt;&amp;#34;Never gonna make you cry, never gonna say goodbye&lt;/span&gt;&lt;span style=&#34;color:#89b4fa&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#a6e3a1&#34;&gt;Never gonna tell a lie and hurt you&lt;/span&gt;&lt;span style=&#34;color:#89b4fa&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#a6e3a1&#34;&gt;&amp;#34;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#cba6f7&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#fab387&#34;&gt;0&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;So there&amp;rsquo;s a small security measure that makes it so you can&amp;rsquo;t call main twice.&#xA;That&amp;rsquo;s fine though cause you can just jump into the middle of the main function.&#xA;So you can just use the pwntools library to create the format string writes for&#xA;you. You just need to find the offset of your input in the printf call. The&#xA;compiler also changes the last printf call to &lt;code&gt;puts()&lt;/code&gt; so you can utilize that&#xA;knowledge to overwrite the GOT of puts with the location of &lt;code&gt;fgets()&lt;/code&gt; in the &lt;code&gt;main()&lt;/code&gt;&#xA;function. Then you can just get as much input as you want since it loops. Next step&#xA;is to leak libc and replace &lt;code&gt;printf()&lt;/code&gt; with &lt;code&gt;system()&lt;/code&gt;. Here&amp;rsquo;s the exploit.&lt;/p&gt;</description>
    </item>
    <item>
      <title>pwn/rut_roh_relro</title>
      <link>http://localhost:1313/cyber/lactf23/relro/</link>
      <pubDate>Sun, 12 Feb 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/cyber/lactf23/relro/</guid>
      <description>&lt;h3 id=&#34;the-challenge&#34;&gt;&#xA;  The challenge&#xA;  &lt;a class=&#34;heading-link&#34; href=&#34;#the-challenge&#34;&gt;&#xA;    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;&#xA;    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&#xA;&lt;p&gt;This was a printf format string vulnerability. The program gets your input&#xA;then calls &lt;code&gt;printf()&lt;/code&gt; on that input. Then it repeats that again. The relro&#xA;and PIE are what make this more difficult than the rick-roll challenge. Instead&#xA;of exploiting the GOT (which is read-only). You can read the address of libc as&#xA;well as the return address on the stack, then you can use the format string write&#xA;in order to create a ROP chain that just calls &lt;code&gt;system(&#39;/bin/sh&#39;)&lt;/code&gt;.&lt;/p&gt;</description>
    </item>
    <item>
      <title>rev/switcheroo</title>
      <link>http://localhost:1313/cyber/lactf23/switcheroo/</link>
      <pubDate>Sun, 12 Feb 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/cyber/lactf23/switcheroo/</guid>
      <description>&lt;h3 id=&#34;the-challenge&#34;&gt;&#xA;  The challenge&#xA;  &lt;a class=&#34;heading-link&#34; href=&#34;#the-challenge&#34;&gt;&#xA;    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;&#xA;    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&#xA;&lt;p&gt;The was a switch statement written in assembly. I&amp;rsquo;m not amazing at REV,&#xA;so I was a little bit slow at this. Essentially the concept was to have&#xA;a region of memory that acted as a &amp;ldquo;key&amp;rdquo;. Each character of the user input&#xA;would act as an index to an 8-byte region of this memory. Then it would take&#xA;the 8 bytes and do some math on it. I was a little hazy on the details, but&#xA;essentially it would to an 8-bit rotation of the memory and grab the last byte&#xA;of that value and compare it to the running index count. If it was larger than&#xA;the index, it would rotate again. If it was smaller than the index, it would&#xA;move on to the next input and that char would be considered correct. I used&#xA;this knowledge to create most of the flag, but there were some issues with it&#xA;since the program didn&amp;rsquo;t necessarily do this exact algorithm. I was able to fill&#xA;in the rest of the flag by testing out different rotation counts for each step.&#xA;Here&amp;rsquo;s my exploit code. It&amp;rsquo;s pretty messy, but it got it done.&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
