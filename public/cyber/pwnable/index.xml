<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Pwnable.tw on Lucas Ball</title>
    <link>http://localhost:1313/cyber/pwnable/</link>
    <description>Recent content in Pwnable.tw on Lucas Ball</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 09 May 2023 00:22:46 -0700</lastBuildDate>
    <atom:link href="http://localhost:1313/cyber/pwnable/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Babystack</title>
      <link>http://localhost:1313/cyber/pwnable/babystack/</link>
      <pubDate>Tue, 09 May 2023 00:22:46 -0700</pubDate>
      <guid>http://localhost:1313/cyber/pwnable/babystack/</guid>
      <description>&lt;h1 id=&#34;the-binary&#34;&gt;&#xA;  The binary&#xA;  &lt;a class=&#34;heading-link&#34; href=&#34;#the-binary&#34;&gt;&#xA;    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;&#xA;    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&#xA;&lt;p&gt;So this binary is super small, but it&amp;rsquo;s stripped for the&#xA;most part making it pretty annoying to work with. I opened&#xA;it up in ghidra and found the main function. Essentially what&#xA;the program does is open up the &lt;code&gt;/dev/urandom&lt;/code&gt; file on the&#xA;filesystem and save 16 bytes of that to a local variable. This&#xA;is shown here:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-C&#34; data-lang=&#34;C&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;rand_fp &lt;span style=&#34;color:#89dceb;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#89b4fa&#34;&gt;open&lt;/span&gt;(&lt;span style=&#34;color:#a6e3a1&#34;&gt;&amp;#34;/dev/urandom&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#fab387&#34;&gt;0&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#89b4fa&#34;&gt;read&lt;/span&gt;(rand_fp,&lt;span style=&#34;color:#89dceb;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;rand_str,&lt;span style=&#34;color:#fab387&#34;&gt;0x10&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;puVar1 &lt;span style=&#34;color:#89dceb;font-weight:bold&#34;&gt;=&lt;/span&gt; DAT_00302020;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#89dceb;font-weight:bold&#34;&gt;*&lt;/span&gt;DAT_00302020 &lt;span style=&#34;color:#89dceb;font-weight:bold&#34;&gt;=&lt;/span&gt; rand_str;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;puVar1[&lt;span style=&#34;color:#fab387&#34;&gt;1&lt;/span&gt;] &lt;span style=&#34;color:#89dceb;font-weight:bold&#34;&gt;=&lt;/span&gt; local_20;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#89b4fa&#34;&gt;close&lt;/span&gt;(rand_fp);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;rand_str is what I named this random string that gets pulled from&#xA;the urandom file.&lt;/p&gt;</description>
    </item>
    <item>
      <title>3x17</title>
      <link>http://localhost:1313/cyber/pwnable/3x17/</link>
      <pubDate>Fri, 27 Jan 2023 19:46:10 -0800</pubDate>
      <guid>http://localhost:1313/cyber/pwnable/3x17/</guid>
      <description>&lt;p&gt;This challenge was relatively difficult for me and introduced a few new concepts to me. Overall a pretty good challenge I would say.&lt;/p&gt;&#xA;&lt;p&gt;I started out by looking at the binary information to see what&amp;rsquo;s going on. Calling &lt;code&gt;pwn checksec ./3x17&lt;/code&gt; shows this:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; Arch:     amd64-64-little&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; RELRO:    Partial RELRO&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; Stack:    No canary found&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; NX:       NX enabled&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; PIE:      No PIE &lt;span style=&#34;color:#89dceb;font-weight:bold&#34;&gt;(&lt;/span&gt;0x400000&lt;span style=&#34;color:#89dceb;font-weight:bold&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Nice! No PIE and no canary. That makes it easier. Wait a second&amp;hellip;&lt;code&gt;file ./3x17&lt;/code&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Calc</title>
      <link>http://localhost:1313/cyber/pwnable/calc/</link>
      <pubDate>Fri, 27 Jan 2023 19:46:10 -0800</pubDate>
      <guid>http://localhost:1313/cyber/pwnable/calc/</guid>
      <description>&lt;h1 id=&#34;calc&#34;&gt;&#xA;  Calc&#xA;  &lt;a class=&#34;heading-link&#34; href=&#34;#calc&#34;&gt;&#xA;    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;&#xA;    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&#xA;&lt;p&gt;Alrighty then. This was definitely a tough one. Time to put my thinking hat on and get to work. First thing&amp;rsquo;s first, lets pull this up in ghidra and see what this is all about.&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f38ba8&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#89b4fa&#34;&gt;main&lt;/span&gt;(){&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#89b4fa&#34;&gt;signal&lt;/span&gt;(&lt;span style=&#34;color:#fab387&#34;&gt;0xe&lt;/span&gt;,timeout);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#89b4fa&#34;&gt;alarm&lt;/span&gt;(&lt;span style=&#34;color:#fab387&#34;&gt;0x3c&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#89b4fa&#34;&gt;puts&lt;/span&gt;(&lt;span style=&#34;color:#a6e3a1&#34;&gt;&amp;#34;=== Welcome to SECPROG calculator ===&amp;#34;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#89b4fa&#34;&gt;fflush&lt;/span&gt;((FILE &lt;span style=&#34;color:#89dceb;font-weight:bold&#34;&gt;*&lt;/span&gt;)stdout);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#89b4fa&#34;&gt;calc&lt;/span&gt;();&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#89b4fa&#34;&gt;puts&lt;/span&gt;(&lt;span style=&#34;color:#a6e3a1&#34;&gt;&amp;#34;Merry Christmas!&amp;#34;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#cba6f7&#34;&gt;return&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Looks like it&amp;rsquo;s got a timer on it, so you can&amp;rsquo;t take too long to do your thing on the program. Good thing we&amp;rsquo;ll only end up needing a few seconds. The function we want to look at here is the &lt;code&gt;calc()&lt;/code&gt; function:&lt;/p&gt;</description>
    </item>
    <item>
      <title>Dubblesort</title>
      <link>http://localhost:1313/cyber/pwnable/dubblesort/</link>
      <pubDate>Fri, 27 Jan 2023 19:46:10 -0800</pubDate>
      <guid>http://localhost:1313/cyber/pwnable/dubblesort/</guid>
      <description>&lt;h1 id=&#34;dubblesort&#34;&gt;&#xA;  Dubblesort&#xA;  &lt;a class=&#34;heading-link&#34; href=&#34;#dubblesort&#34;&gt;&#xA;    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;&#xA;    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&#xA;&lt;p&gt;Okay this was by far the most frustrating challenge yet. So many issues that took way too long to fix. Nevertheless, it&amp;rsquo;s solved and here&amp;rsquo;s how it&amp;rsquo;s done.&lt;/p&gt;&#xA;&lt;p&gt;Start out by checking the security on the binary:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;pwn checksec ./dubblesort&#xA;    Arch:     i386-32-little&#xA;    RELRO:    Full RELRO&#xA;    Stack:    Canary found&#xA;    NX:       NX enabled&#xA;    PIE:      PIE enabled&#xA;    FORTIFY:  Enabled&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Yikes. Alright looks like there&amp;rsquo;s gonna be a very specific bug here. Lets test out the program to see what happens:&lt;/p&gt;</description>
    </item>
    <item>
      <title>orw</title>
      <link>http://localhost:1313/cyber/pwnable/orw/</link>
      <pubDate>Fri, 27 Jan 2023 19:46:10 -0800</pubDate>
      <guid>http://localhost:1313/cyber/pwnable/orw/</guid>
      <description>&lt;h1 id=&#34;orwmd&#34;&gt;&#xA;  &lt;a href=&#34;orw.md&#34; &gt;orw.md&lt;/a&gt;&#xA;  &lt;a class=&#34;heading-link&#34; href=&#34;#orwmd&#34;&gt;&#xA;    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;&#xA;    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&#xA;&lt;h1 id=&#34;orw-write-up&#34;&gt;&#xA;  ORW write-up&#xA;  &lt;a class=&#34;heading-link&#34; href=&#34;#orw-write-up&#34;&gt;&#xA;    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;&#xA;    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&#xA;&lt;p&gt;Starting this challenge I ran &lt;code&gt;pwn checksec&lt;/code&gt; on the program to get the info on the security measures for the binary:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Arch:     i386-32-little&#xA;RELRO:    Partial RELRO&#xA;Stack:    Canary found&#xA;NX:       NX disabled&#xA;PIE:      No PIE (0x8048000)&#xA;RWX:      Has RWX segments&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;After running the binary I quickly realized these security measures didnâ€™t matter. Running the binary in GDB gave me the functionality of the program: &lt;code&gt;disass main&lt;/code&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Start</title>
      <link>http://localhost:1313/cyber/pwnable/start/</link>
      <pubDate>Fri, 27 Jan 2023 19:46:10 -0800</pubDate>
      <guid>http://localhost:1313/cyber/pwnable/start/</guid>
      <description>&lt;p&gt;Alright so my first steps were to download the binary and open it up in ghidra. Opening it up in ghidra yielded nothing because the program was a super basic opcodes. With no libraries. This made it really hard for ghidra to figure out what the functions were really doing. This meant I would have to open it up in GDB to see what was happening in the dissassembly.&lt;/p&gt;&#xA;&lt;p&gt;I first ran the program to see what it did. All it did was send a 20-byte message:&#xA;&lt;code&gt;Let&#39;s start the CTF:&lt;/code&gt;&#xA;then it gave a prompt. It seemed like anything you sent in the prompt would exit the program.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Seethefile</title>
      <link>http://localhost:1313/cyber/pwnable/seethefile/</link>
      <pubDate>Fri, 27 Jan 2023 18:46:22 -0800</pubDate>
      <guid>http://localhost:1313/cyber/pwnable/seethefile/</guid>
      <description>&lt;hr&gt;&#xA;&lt;h3 id=&#34;how-this-program-works&#34;&gt;&#xA;  How this program works&#xA;  &lt;a class=&#34;heading-link&#34; href=&#34;#how-this-program-works&#34;&gt;&#xA;    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;&#xA;    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&#xA;&lt;p&gt;We start with a simple menu with 5 options. This is what that looks like:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;---------------MENU---------------&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 1. Open&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 2. Read&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 3. Write to screen&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 4. Close&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 5. Exit&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;----------------------------------&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Your choice :&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Okay this looks like a simple file reader. Looks like you can read any file&#xA;in the filesystem and print it to the screen with open/read/write. Opening&#xA;it up in Ghidra shows that my prediction was mostly correct. Here&amp;rsquo;s the&#xA;pseudo-code generated by Ghidra for the openfile() function:&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
